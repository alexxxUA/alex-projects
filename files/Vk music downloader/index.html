<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>VK music saver</title>
	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="css/style.css">
</head>
<body>
	<div class="main-container">
		<h1>Скачивание музыки с "vk.com"</h1>
		<a class="vk-bookmark" alt="Перетащи меня в панель закладок" title="Перетащи меня в панель закладок" href='javascript: (function() {	var swfScriptUrl = "//avasin.cf/Vk%20music%20downloader/OpenSave/opensave.js",		audioCounter = 0,		audioBtnOptions = {			width: 20,			height: 20,			image_up: "//avasin.cf/Vk%20music%20downloader/img/dImg_20x20.png",			swf: "//avasin.cf/Vk%20music%20downloader/OpenSave/opensave.swf",			filename: "",			url: "",			buttonDiv: ""		};	function loadScript(url, callback){		var script = document.createElement("script");		script.type = "text/javascript";		if (script.readyState){			script.onreadystatechange = function(){				if (script.readyState == "loaded" || script.readyState == "complete"){						script.onreadystatechange = null;						callback();				}			}		}		else {			script.onload = function(){				callback();			};		}		script.src = url;		document.getElementsByTagName("head")[0].appendChild(script);	}	function setCss(cssString){		var head = document.head || document.getElementsByTagName("head")[0],			style = document.createElement("style");		style.type = "text/css";		if (style.styleSheet){			style.styleSheet.cssText = cssString;		}		else{			style.appendChild(document.createTextNode(cssString));		}		head.appendChild(style);	}	function getContent(innerHTML){		return innerHTML.replace(/<[^>]*>/g, "");	}	function each($elements, callback){		for(var i=0; i<$elements.length; i++){			callback($elements[i]);		}	}	function getDownloadLink(event){		var $audios = document.querySelectorAll(".audio:not(#audio_global)");		each($audios, function ($this){			if(!$this.querySelectorAll(".vkDownloadWrap")[0]){				var $dContainer = $this.querySelector(".title_wrap"),					dUrl = ($this.querySelector("input")).value.replace(/\?.*/g, ""),					dTitleAuthor = getContent( ($this.querySelectorAll("b a")[0]).innerHTML ),					dTitleSong = getContent( ($this.querySelectorAll("span.title")[0]).innerHTML ),					dFullTitle = (dTitleAuthor +" - "+ dTitleSong).replace(/^\s*|\s*$/gm, "").substr(0, 255).replace(/[/\\:*?"<>|%@]/gm, " "),					dWrap = document.createElement("a"),					dBtn = document.createElement("span");				audioBtnOptions.filename = dFullTitle +".mp3";				audioBtnOptions.url = dUrl;				audioBtnOptions.buttonDiv = "vkDownload" + audioCounter;				dWrap.className = "vkDownloadWrap";				dBtn.id = "vkDownload" + audioCounter;				dWrap.appendChild(dBtn);				$dContainer.insertBefore(dWrap, $dContainer.childNodes[0]);				opensave.make(audioBtnOptions);				audioCounter++;			}		});	}	loadScript(swfScriptUrl, function(){		setCss(".vkDownloadWrap{float: left; margin: -3px 2px 0 0; z-index: 999999; width: 20px; height: 20px;} .area{position: relative;} .audio_fixed_nav #page_header, .audio_fixed_nav #ac{z-index: 999999999999;}");		getDownloadLink();		document.addEventListener("scroll", getDownloadLink);		console.info("Script loaded and started!");	});})();' >VK Music</a>
		<ol>
			<li>Перетащить кнопку "VK Music" (синяя кнопка вверху) в панель закладок;</li>
			<li>На странице с музыкой нажать на закладку "VK Music" в панеле закладок, которая была создана в 1-м шаге;</li>
			<li>Ссылки для скачивания музыки появятся возле каждой композиции.</li>
		</ol>
		<h4>Enjoy, it's simple <span class="yellow">;)</span></h4>
	</div>
	<div class="bg"></div>
	<div class="modal">
		<a href="#" class="close">&times;</a>
		<h4>Ваш браузер поддерживает данный скрипт для скачивания музыки с <a href="http://vk.com" target="_blank">Вконтакте</a> только <b>частично</b>!</h4>
		<p>Для полноценной работы данного скрипта, нужен один из браузеров: <a href="http://www.google.com.ua/intl/ru/chrome" target="_blank">Google Chrome</a> или <a href="http://www.opera.com/ru/computer/next" target="_blank">Opera Next</a>.</p>	
	</div>
	<script type="text/javascript" src="js/app.js"></script>
</body>
</html>